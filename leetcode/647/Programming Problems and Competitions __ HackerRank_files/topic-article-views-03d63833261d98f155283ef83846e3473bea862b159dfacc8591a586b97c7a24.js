(function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var CommonTopicView,HR,ref;return CommonTopicView=function(superClass){function CommonTopicView(){return CommonTopicView.__super__.constructor.apply(this,arguments)}return extend(CommonTopicView,superClass),CommonTopicView.prototype.initialize=function(){return _.bindAll(this,"documentScroll"),$(window).scroll(this.documentScroll)},CommonTopicView.prototype.documentScroll=function(){var toc_top;return toc_top=50,this.$(".hackdown").each(function(){var hack_offset,hackdown_element,hackdown_toc_element,height,toc_left,toc_offset,width,window_top;if(0!==(hackdown_toc_element=(hackdown_element=$(this)).find(".hackdown-fixed")).length)return hackdown_toc_element=hackdown_toc_element.first(),hack_offset=hackdown_element.offset(),toc_offset=hackdown_toc_element.offset(),(window_top=$(window).scrollTop())+toc_top<hack_offset.top?hackdown_toc_element.removeClass("fixed"):window_top+toc_top>=hack_offset.top&&window_top+hackdown_toc_element.height()+toc_top<hack_offset.top+hackdown_element.height()?(hackdown_toc_element.hasClass("fixed")||(width=hackdown_toc_element.css("width"),height=hackdown_toc_element.css("height"),hackdown_toc_element.addClass("fixed"),hackdown_toc_element.css("left",toc_offset.left),hackdown_toc_element.css("top",toc_top),hackdown_toc_element.css("max-width",width),hackdown_toc_element.css("max-height",height)),parseInt(hackdown_toc_element.css("top"))!==toc_top&&hackdown_toc_element.css("top",toc_top),toc_left=.75*parseInt(hackdown_element.css("width"))+hack_offset.left,parseInt(hackdown_toc_element.css("left"))!==toc_left?hackdown_toc_element.css("left",toc_left):void 0):window_top<hack_offset.top+hackdown_element.height()?(hackdown_toc_element.hasClass("fixed")||hackdown_toc_element.addClass("fixed"),hackdown_toc_element.css("top",hack_offset.top+hackdown_element.height()-window_top-hackdown_toc_element.height())):hackdown_toc_element.removeClass("fixed")})},CommonTopicView.prototype.events={"click .scroll-to-topics-top":"scrollToTop","click li.toc-title-link, a.toc-title-link":"titleLinkClick","click a.hryoutube-open-modal":"renderYoutubeModal","click .hackdown-tab":"toggleHackdownTab","click a.answer-true":function(e){return this.$(e.currentTarget).removeClass("circle-empty").addClass("icon-ok")},"click a.answer-false":function(e){return this.$(e.currentTarget).removeClass("circle-empty").addClass("icon-cancel-large")},"recommendation-shown .hackdown-article":"recommendationShown","recommendation-shown .hackdown-recommendation":"recommendationShown","click a.runcode-run-btn":"runCode"},CommonTopicView.prototype.scrollToTop=function(){return this.$("#content").length>0?$("html,body").animate({scrollTop:this.$("#content").offset().top}):this.$(".topics-list-container").length>0?$("html,body").animate({scrollTop:this.$(".topics-list-container").offset().top-150}):$("html,body").animate({scrollTop:0})},CommonTopicView.prototype.titleLinkClick=function(e){return e.stopImmediatePropagation(),e.preventDefault(),$("html,body").animate({scrollTop:this.$(this.$(e.currentTarget).attr("data-href")).offset().top})},CommonTopicView.prototype.scrollToHackdownTop=function(e){var hackdown_parent;return hackdown_parent=this.$(e.currentTarget).closest(".hackdown"),$("html,body").animate({scrollTop:hackdown_parent.offset().top})},CommonTopicView.prototype.renderYoutubeModal=function(e){var current_hacker,youtube_id;return e.stopImmediatePropagation(),e.preventDefault(),youtube_id=this.$(e.currentTarget).attr("data-id"),current_hacker=HR.profile(),new HR.util.VideoDialog({youtube_id:youtube_id,title:"",username:current_hacker.get("username"),hacker_id:current_hacker.get("id")}).render()},CommonTopicView.prototype.toggleHackdownTab=function(e){var $target,obj;return $target=this.$(e.currentTarget),(obj=$target.next()).hasClass("toggled")?($target.removeClass("toggled-tab"),obj.slideDown(function(){if(obj.removeClass("toggled"),obj.hasClass("hackdown-recommendation")||obj.hasClass("hackdown-article"))return obj.trigger("recommendation-shown")})):obj.slideUp(function(){return obj.addClass("toggled"),$target.addClass("toggled-tab")})},CommonTopicView.prototype.renderHackdownCode=function(){var generateRunCodeBlock;return generateRunCodeBlock=function($elem){var $input_elem,code,code_mirror,language;if(!$elem.hasClass("runcode-rendered"))return $elem.addClass("runcode-rendered"),code=$elem.text().trim(),language=$elem.attr("data-code-language"),code_mirror=$("<div></div>").addClass("runcode-codemirror"),HR.appController.loadCodeMirrorMode(language,function(){return $elem.after(code_mirror),CodeMirror(code_mirror[0],{value:code,lineNumbers:!0,mode:lang_mime_mapping[language],readOnly:!0}),$elem.hide()}),$input_elem=$elem.closest(".hackdown-runcode").find(".runcode-run .runcode-input"),$elem.closest(".hackdown-runcode").find(".runcode-run .runcode-output"),0===$input_elem.val().length?$input_elem.parent().hide():void 0},this.$(".runcode-code").each(function(){return generateRunCodeBlock($(this))}),this.hackdownLoaded()},CommonTopicView.prototype.hackdownLoaded=function(){return this.$(".hackdown-recommendation").each(function(){return $(this).trigger("recommendation-shown")}),this.$(".hackdown-article").each(function(){return $(this).trigger("recommendation-shown")})},CommonTopicView.prototype.runCode=function(e){var $elem,challenge_slug,code,code_object,compile_test1,input,language,output_object;if(!($elem=this.$(e.currentTarget)).hasClass("disabled"))return $elem.addClass("disabled"),code=(code_object=$elem.closest(".hackdown-runcode").find(".runcode-code")).text(),(language=code_object.attr("data-code-language"))||(language="c"),input=$elem.closest(".runcode-run").find(".runcode-input").val(),output_object=$elem.closest(".runcode-run").find(".runcode-output"),challenge_slug="topic-article-submissions",(compile_test1=new HR.CompileTestModel({code:code,language:language})).setChallenge(new HR.ChallengeModel({slug:challenge_slug})),compile_test1.set("customtestcase",!0),compile_test1.set("custominput",input),compile_test1.save(null,{error:function(){return $elem.removeClass("disabled")}}),compile_test1.bind("change:status",function(model,status1){var lines,output,signal;if(status1>0)return model.get("errors")||!model.get("status")||0!==model.get("result")?void output_object.val("ERROR"):(void 0!==(signal=model.get("signal")[0])&&0===signal?(output=model.get("stdout")[0],output_object.val(output),lines=Math.min(output.split("\n").length,15),output_object.attr("rows",lines)):null!=model.get("stderr")&&null!=model.get("stderr")[0]?(output=model.get("stderr")[0],output_object.val(output),lines=Math.min(output.split("\n").length,15),output_object.attr("rows",lines)):output_object.val("Unexpected Error.\nPlease try again after some time"),$elem.removeClass("disabled"))})},CommonTopicView.prototype.recommendationShown=function(e){var $elem,a_id,c_id,preview,that,title;return that=this,$elem=this.$(e.currentTarget),c_id=$elem.attr("data-challenge-id"),a_id=$elem.attr("data-article-id"),title=void 0,preview=void 0,c_id?($elem.html("<span class='inline-throbber loading'></span>"),$.ajax({dataType:"json",url:"/rest/contests/master/challenges/"+c_id,success:function(data){return title=data.model.name,$elem.html(""),$elem.append("<a class='btn btn-primary backbone pull-right' href='/challenges/"+c_id+"/'>Solve</a>"),preview=data.model.preview,title&&($elem.append("<h3>"+title+"</h3>"),$elem.prev(".hackdown-tab").html(title+"<span class='pull-right hackdown-context'>Recommended Challenge</span>")),preview&&$elem.append("<p>"+preview+"</p>"),$elem.removeAttr("data-challenge-id")}})):a_id?$.ajax({dataType:"json",url:"/rest/topics/"+a_id,success:function(data){var $e,current_content;if($elem.attr("data-article-id"))if($elem.removeAttr("data-article-id"),title=data.model.title,current_content=$elem.html(),$elem.html(""),$elem.hasClass("show-full-article")){if(preview=data.model.content_html,title&&($elem.append('<h1 class="plL">'+title+"</h1>"),$elem.prev(".hackdown-tab").html(title+"<span class='pull-right hackdown-context'>Article</span>")),preview)return $e=$("<div></div>").html(preview),$(".hackdown-fixed",$e).remove(),$(".hackdown-toc",$e).remove(),$(".hackdown-full-article-parent-tab",$e).remove(),$(".show-full-article",$e).remove(),$elem.append($e),that.renderHackdownCode()}else if(preview=current_content,$elem.append("<a class='btn btn-primary backbone pull-right' href='/topics/"+a_id+"/'>View</a>"),title&&($elem.append("<h3>"+title+"</h3>"),$elem.prev(".hackdown-tab").html(title+"<span class='pull-right hackdown-context'>Recommended Article</span>")),preview)return $elem.append(preview)}}):void 0},CommonTopicView}(window.HR.GenericView),(HR=null!=(ref=window.HR)?ref:{}).CommonTopicView=CommonTopicView})}).call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,UnlinkedTopicView,ref;return UnlinkedTopicView=function(superClass){function UnlinkedTopicView(){return UnlinkedTopicView.__super__.constructor.apply(this,arguments)}return extend(UnlinkedTopicView,superClass),UnlinkedTopicView.prototype.template="unlinked-topic",UnlinkedTopicView.prototype.className="topic-view plT",UnlinkedTopicView.prototype.events=function(){return _.extend({},window.HR.CommonTopicView.prototype.events||{},{"dummy-event":"dummyMethod"})},UnlinkedTopicView.prototype.initialize=function(){return UnlinkedTopicView.__super__.initialize.call(this),this.listenTo(this.model,"reset",this.render)},UnlinkedTopicView.prototype.setBreadcrumb=function(){return HR.appView.setBreadcrumb("global","Articles","/"),HR.appView.setBreadcrumb("primary-track",this.model.get("title"),"/topics/"+this.model.get("slug"))},UnlinkedTopicView.prototype.render=function(){var renderTopic,_this;return this.model&&this.model.get("title")&&(_this=this,renderTopic=function(){return $(_this.el).html(HR.appController.template(_this.template,_this)({model:_this.model.toJSON()})),_this.renderHackdownCode()},HR.requires(["MathJax/MathJax"],renderTopic),renderTopic()),this},UnlinkedTopicView}(window.HR.CommonTopicView),(HR=null!=(ref=window.HR)?ref:{}).UnlinkedTopicView=UnlinkedTopicView})}.call(this);